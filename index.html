<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lore Playground Gallery</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #050505;
            color: #e5e5e5;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
        }

        /* Header */
        header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 1000;
            border-bottom: 1px solid #222;
        }

        .logo {
            font-size: 18px;
            font-weight: 700;
            background: linear-gradient(45deg, #d4af37, #ffb6c1, #d4af37, #ffb6c1, #d4af37);
            background-size: 200% auto;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: metallic 3s linear infinite;
            letter-spacing: 2px;
        }

        @keyframes metallic {
            0% { background-position: 0% center; }
            100% { background-position: 200% center; }
        }

        .subtitle {
            font-size: 10px;
            color: #666;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        /* Gallery Container */
        .gallery-container {
            padding-top: 50px;
            padding-left: 10px;
            padding-right: 10px;
            padding-bottom: 40px;
        }

        /* Gallery Grid */
        .gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 6px;
        }

        .gallery-item {
            position: relative;
            aspect-ratio: 1;
            overflow: hidden;
            cursor: pointer;
            background: #111;
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease, filter 0.3s ease;
            filter: grayscale(30%);
        }

        .gallery-item:hover img {
            transform: scale(1.05);
            filter: grayscale(0%);
        }

        .gallery-item .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #444;
            font-size: 12px;
        }

        .gallery-item.error img {
            opacity: 0.1;
        }

        .gallery-item .error-icon {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-size: 24px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 1400px;
            margin: auto;
            padding: 20px;
            gap: 20px;
        }

        @media (min-width: 900px) {
            .modal-content {
                flex-direction: row;
                align-items: flex-start;
            }
        }

        .modal-image-container {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
        }

        .modal-image {
            max-width: 100%;
            max-height: 60vh;
            object-fit: contain;
            border: 1px solid #222;
        }

        .modal-info {
            flex: 0 0 400px;
            max-width: 100%;
            background: #0a0a0a;
            border: 1px solid #222;
            padding: 20px;
        }

        .modal-close {
            position: fixed;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: #888;
            font-size: 28px;
            cursor: pointer;
            z-index: 2001;
            transition: color 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
        }

        .modal-close:hover {
            color: #fff;
        }

        .info-section {
            margin-bottom: 20px;
        }

        .info-label {
            font-size: 10px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-value {
            font-size: 13px;
            color: #ccc;
            line-height: 1.5;
            word-break: break-word;
            max-height: 150px;
            overflow-y: auto;
            padding: 12px;
            background: #111;
            border: 1px solid #222;
        }

        .copy-btn {
            background: #1a1a1a;
            border: 1px solid #333;
            color: #888;
            padding: 6px 12px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .copy-btn:hover {
            background: #2d1b4e;
            border-color: #4a1359;
            color: #fff;
        }

        .copy-btn.copied {
            background: #1b4e2d;
            border-color: #2d7a4e;
            color: #8f8;
        }

        .seed-value {
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: #d4af37;
            background: #111;
            padding: 12px;
            border: 1px solid #222;
        }

        .modal-meta {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #222;
            flex-wrap: wrap;
        }

        .meta-item {
            font-size: 11px;
            color: #666;
        }

        .meta-item span {
            color: #999;
        }

        /* Loading */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #050505;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 3000;
        }

        .loading-overlay.hidden {
            display: none;
        }

        .loading-text {
            color: #444;
            font-size: 14px;
            letter-spacing: 2px;
            margin-bottom: 20px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 2px solid #222;
            border-top-color: #4a1359;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #1b4e2d;
            color: #8f8;
            padding: 12px 24px;
            font-size: 13px;
            border: 1px solid #2d7a4e;
            z-index: 4000;
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #111;
        }

        ::-webkit-scrollbar-thumb {
            background: #333;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #444;
        }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">LOADING GALLERY...</div>
    </div>

    <!-- Header -->
    <header>
        <div class="logo">LORE</div>
        <div class="subtitle">Playground gallery</div>
    </header>

    <!-- Gallery -->
    <div class="gallery-container">
        <div class="gallery" id="gallery"></div>
    </div>

    <!-- Modal -->
    <div class="modal" id="modal">
        <button class="modal-close" onclick="closeModal()">&times;</button>
        <div class="modal-content">
            <div class="modal-image-container">
                <img class="modal-image" id="modalImage" src="" alt="">
            </div>
            <div class="modal-info">
                <div class="modal-meta" id="modalMeta"></div>
                
                <div class="info-section">
                    <div class="info-label">
                        Seed
                        <button class="copy-btn" onclick="copySeed()">Copy</button>
                    </div>
                    <div class="seed-value" id="modalSeed"></div>
                </div>

                <div class="info-section">
                    <div class="info-label">
                        Prompt
                        <button class="copy-btn" onclick="copyPrompt()">Copy</button>
                    </div>
                    <div class="info-value" id="modalPrompt"></div>
                </div>

                <div class="info-section">
                    <div class="info-label">
                        Negative
                        <button class="copy-btn" onclick="copyNegative()">Copy</button>
                    </div>
                    <div class="info-value" id="modalNegative"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast -->
    <div class="toast" id="toast">Copied to clipboard</div>

    <script>
        const BASE_URL = 'https://raw.githubusercontent.com/T0nt0o/Promptofolio_Lore';
        
        // ===== DONNÉES CSV INTÉGRÉES =====
        const CSV_DATA = `File,Title,Prompt,Removed_From_Image,Model,Filter,Sampler,Seed,Source,Created
SERONDA-PG-0001,NA,"A surreal illustration features a young woman with long, straight black hair and bangs sitting at an abstractly designed table holding a delicate teacup adorned with intricate blue and gold patterns. Her large, expressive eyes are accentuated with vibrant rainbow-colored makeup, creating a mesmerizing effect against her pale skin. The woman has a contemplative expression, gazing downward as she holds the cup with both of her anatomically perfect hands. She wears a colorful, floral-patterned top with elaborate designs in shades of green, orange, pink, yellow, purple, and red on the sleeves. On the table, there are three cups of coffee or tea, each uniquely styled. A light green cup with ridged edges sits on a saucer to the left, filled with steaming light brown liquid. An orange-brown cup with dark brown liquid is centrally placed on a white saucer. To the right, another peach-colored cup rests on a saucer. The background depicts a cosmic scene filled with swirling nebulae, planets, stars, and other celestial elements. These include an amber-orange spiral planet in the upper left corner, variously sized spherical objects in shades of red, green, and blue scattered throughout, and abstract, colorful cloud-like formations intertwining in vibrant hues of green, blue, pink, purple, yellow, and orange. Small crescent moons and floating flowers are interspersed among the starry expanse. A small boat-shaped object containing mysterious symbols floats near the top left, while two abstract shapes resembling faces or mask-like figures appear in the bottom right corner. The overall mood is dreamy, ethereal, and introspective, enhanced by the high contrast between the vivid colors of the foreground and the deep blacks of the cosmic backdrop. The composition blends realistic portrait elements with fantastical cosmic imagery, creating a whimsical and otherworldly atmosphere that emphasizes the surreal quality of the artwork.","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, extra limbs, EXTRA FINGERS, awkward hands, poorly drawn face, poorly drawn hands, missing fingers, nudity, nude",Playground v3 (beta),NA,NA,678665420,NA,202409240514
SERONDA-PG-1011,today is the day we say goodbye :(,"surreal minimal collage, concept art, grim, dreamy, dark art, macabre, cool toned, grunge, Stylized painting surreal colors, chromatic aberration. double exposure effect, a beautiful woman superimposed against a maximalist landscape, liminal space, In the style of, Catrin Welz-Stein, burtonian, Naoko Takeuchi","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, cross-eyed, strabismus, poorly drawn eyes, assymetrical eyes, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,486752610,Canvas,202409231558
SERONDA-PG-1012,NA,"Collage blending retrofuturism, surrealism, realism infused with fantasy elements, domme centrally positioned amidst anachronistic devices, ethereal creatures mingling with Art Deco shapes, dreamlike cityscape backdrop, neon hues contrasting monochrome palette, photomontage, digital painting, octane rendering","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, cross-eyed, strabismus, poorly drawn eyes, assymetrical eyes, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,717360247,Canvas,202409231556
SERONDA-PG-2045,NA,"dreamy mood, dreamy atmosphere, Beautiful seductive smiling beautiful stunning fairy by agnes cecile julie doucet moebius, intricated details, sitting, facing camera, hair styled in a bun, bend over posture, full body portrait, extremely luminous bright design, soft colours, by Karol Bak and Jean-Baptiste Monge","ugly, anime, deformed, noisy, blurry, distorted, out of focus, bad anatomy, cross-eyed, strabismus, poorly drawn eyes, assymetrical eyes, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,950248608,Canvas,202409180412
SERONDA-PG-3019,NA,"Abstract composite photo design with watercolor textures, soft pastel colors, organic flowing shapes, close up, focus on, copy space, double exposure silhouette with creative natural elements.","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,266384131,Canvas,202409230523
SERONDA-PG-3020,NA,"Imagine a collage of retrofuturistic and surreal elements that have been blended with stark realism, dictated by a dominant theme of a 'Domme'. Positioned across the composition, these elements talk of power, control, authority, expressed through iconic retrofuturist symbols, surreal visuals, and hyper-realistic fantasy aspects. Encapsulate the key themes of retrofuturism and surrealism along with pronounced elements of","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, cross-eyed, strabismus, poorly drawn eyes, assymetrical eyes, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,201372862,Canvas,202409230306
SERONDA-PG-3434,NA,"Vibrant Dark academia aesthetic oil painting embodying moody and mysterious atmosphere, epic fantasy elements weave through the whimsical and dreamy vintage composition, style influenced by Pablo Amaringo, Emil Melmoth, cinematic ambiance, dramatic lighting, high contrast, chiaroscuro effects, immersive depth of field, rich textures, gothic","ugly, deformed, noisy, blurry, distorted, out of focus, bad anatomy, cross-eyed, strabismus, poorly drawn eyes, assymetrical eyes, extra limbs, poorly drawn face, hands, fingers, nudity, nude, bad teeth, showing teeth",Playground v2.5,Photorealism,DPM++ 2M Karras,24213521,Canvas,202409232315`;
        
        let galleryData = [];
        let currentItem = null;

        // Branch mapping based on actual image ranges
        // thumbnails2: 1011-2044
        // thumbnails3: 2045-3004
        // thumbnails4: 3019+
        function getBranchAndFolder(filename) {
            // Extract number from filename like "SERONDA-PG-1011"
            const match = filename.match(/SERONDA-PG-(\d+)/);
            if (!match) return { branch: 2, folder: 'thumbnails2' };
            
            const num = parseInt(match[1], 10);
            
            if (num >= 3019) {
                return { branch: 4, folder: 'thumbnails4' };
            } else if (num >= 2045) {
                return { branch: 3, folder: 'thumbnails3' };
            } else {
                return { branch: 2, folder: 'thumbnails2' };
            }
        }

        // Parse CSV
        function parseCSV(text) {
            const lines = text.trim().split('\n');
            const headers = lines[0].split(',').map(h => h.trim());
            const data = [];
            
            for (let i = 1; i < lines.length; i++) {
                const line = lines[i];
                if (!line.trim()) continue;
                
                const row = [];
                let current = '';
                let inQuotes = false;
                
                for (let j = 0; j < line.length; j++) {
                    const char = line[j];
                    if (char === '"') {
                        inQuotes = !inQuotes;
                    } else if (char === ',' && !inQuotes) {
                        row.push(current.trim());
                        current = '';
                    } else {
                        current += char;
                    }
                }
                row.push(current.trim());
                
                const item = {};
                headers.forEach((header, idx) => {
                    item[header] = row[idx] || '';
                });
                
                data.push(item);
            }
            
            return data;
        }

        // Create gallery item
        function createGalleryItem(item) {
            const div = document.createElement('div');
            div.className = 'gallery-item';
            
            const { folder } = getBranchAndFolder(item.File);
            const imageUrl = `${BASE_URL}/${folder}/${item.File}.jpg`;
            
            div.innerHTML = `
                <img src="${imageUrl}" alt="${item.File}" loading="lazy" onerror="handleImageError(this)">
            `;
            
            div.onclick = () => openModal(item);
            
            return div;
        }

        // Handle missing images
        function handleImageError(img) {
            const parent = img.parentElement;
            parent.classList.add('error');
            parent.innerHTML = `<div class="error-icon">?</div>`;
        }

        // Open modal
        function openModal(item) {
            currentItem = item;
            const { branch, folder } = getBranchAndFolder(item.File);
            // For big images, convert thumbnailsN to BigN
            const bigFolder = folder.replace('thumbnails', 'Big');
            const bigUrl = `${BASE_URL}/${bigFolder}/${item.File}.jpg`;
            
            document.getElementById('modalImage').src = bigUrl;
            
            // Meta info
            const metaHtml = `
                <div class="meta-item">Model: <span>${item.Model || 'N/A'}</span></div>
                <div class="meta-item">Sampler: <span>${item.Sampler || 'N/A'}</span></div>
                <div class="meta-item">Filter: <span>${item.Filter || 'N/A'}</span></div>
            `;
            document.getElementById('modalMeta').innerHTML = metaHtml;
            
            document.getElementById('modalSeed').textContent = item.Seed || 'N/A';
            document.getElementById('modalPrompt').textContent = item.Prompt || 'N/A';
            document.getElementById('modalNegative').textContent = item['Removed_From_Image'] || 'N/A';
            
            document.getElementById('modal').classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // Close modal
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
            document.body.style.overflow = '';
            document.getElementById('modalImage').src = '';
        }

        // Copy functions
        function copyToClipboard(text, btn) {
            navigator.clipboard.writeText(text).then(() => {
                btn.textContent = 'Copied!';
                btn.classList.add('copied');
                setTimeout(() => {
                    btn.textContent = 'Copy';
                    btn.classList.remove('copied');
                }, 2000);
                
                const toast = document.getElementById('toast');
                toast.classList.add('show');
                setTimeout(() => toast.classList.remove('show'), 2000);
            });
        }

        function copyPrompt() {
            const btn = event.target;
            copyToClipboard(currentItem.Prompt || 'N/A', btn);
        }

        function copyNegative() {
            const btn = event.target;
            copyToClipboard(currentItem['Removed_From_Image'] || 'N/A', btn);
        }

        function copySeed() {
            const btn = event.target;
            copyToClipboard(currentItem.Seed || 'N/A', btn);
        }

        // Close modal on escape
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeModal();
        });

        // Close modal on background click
        document.getElementById('modal').addEventListener('click', (e) => {
            if (e.target === document.getElementById('modal')) closeModal();
        });

        // Initialize gallery
        function initGallery() {
            try {
                galleryData = parseCSV(CSV_DATA);
                
                const gallery = document.getElementById('gallery');
                
                // Show all items (handle missing images gracefully)
                galleryData.forEach(item => {
                    if (item.Prompt && item.Prompt !== 'NA') {
                        const galleryItem = createGalleryItem(item);
                        gallery.appendChild(galleryItem);
                    }
                });
                
                document.getElementById('loadingOverlay').classList.add('hidden');
                
            } catch (error) {
                console.error('Error loading gallery:', error);
                document.getElementById('loadingOverlay').innerHTML = `
                    <div style="text-align:center;padding:40px 20px;color:#666;">
                        <div style="color:#f55;font-size:18px;margin-bottom:15px;">ERROR LOADING GALLERY</div>
                        <div style="font-size:13px;">Vérifiez la console pour plus de détails.</div>
                    </div>
                `;
            }
        }

        // Start
        initGallery();
    </script>
</body>
</html>